<html>
<head>
  <title>2.0 生命周期 请求数据 fetch</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/303788 (zh-CN, DDL); Windows/6.1.7601 Service Pack 1 (Win32);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="472"/>
<h1>2.0 生命周期 请求数据 fetch</h1>

<div>
<span><div><br/></div><div style="box-sizing: border-box; padding: 8px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; border: 1px solid rgba(0, 0, 0, 0.14902);"><div style="background-color: rgb(251, 250, 248); font-size: 12px;"><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">什么是生命周期：</span></div><div style="background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 10pt; font-family: Monaco;">1.生命周期指的是组件从初始化开始到结束的过程，或者是生命周期是描述react组件从开始到结束的历程</span></div><div style="background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 10pt; font-family: Monaco;">2.每个react组件都有生命周期</span></div><div style="background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 10pt; font-family: Monaco;">3.React都对组件通过生命周期的</span><span style="background-color: rgb(251, 250, 248); font-size: 10pt; font-family: Monaco; font-weight: bold;">钩子函数</span><span style="background-color: rgb(251, 250, 248); font-size: 10pt; font-family: Monaco;">进行管理</span></div><div style="background-color: rgb(251, 250, 248); font-size: 12px;"><br/></div><div style="background-color: rgb(251, 250, 248); font-size: 12px;"><span style="background-color: rgb(251, 250, 248); font-size: 12px;">状态进程三大块  </span><span style="background-color: rgb(251, 250, 248); font-size: 12px; font-weight: bold;">初始化 ==&gt; 运行中 ==&gt; 销毁</span><span style="background-color: rgb(251, 250, 248); font-size: 12px;">：</span></div><div style="background-color: rgb(251, 250, 248); font-size: 12px;"><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><img src="2.0 生命周期 请求数据 fetch_files/Image.png" type="image/png" style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51); height: auto;"/></span></div><div style="background-color: rgb(251, 250, 248); font-size: 12px;"><br/></div><div style="background-color: rgb(251, 250, 248); font-size: 12px;"><hr/></div><div style="background-color: rgb(251, 250, 248); font-size: 12px;"><br/></div><div style="background-color: rgb(251, 250, 248); font-size: 12px;"><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><img src="2.0 生命周期 请求数据 fetch_files/Image [1].png" type="image/png" style="height: auto;"/></span></div><div style="background-color: rgb(251, 250, 248); font-size: 12px;"><div><br/></div></div><div style="background-color: rgb(251, 250, 248); font-size: 12px;"><span style="font-size: 9pt; background-color: rgb(251, 250, 248); font-family: Monaco;"><span style="background-color: rgb(251, 250, 248); font-size: 9pt; font-family: Monaco; font-weight: bold;">初始化</span>阶段可以使用的函数：</span></div><div style="background-color: rgb(251, 250, 248); font-size: 12px;"><div><br/></div></div><div style="background-color: rgb(251, 250, 248); font-size: 12px;"><span style="font-size: 9pt; background-color: rgb(251, 250, 248); font-family: Monaco;"><span style="background-color: rgb(251, 250, 248); font-size: 9pt; font-family: Monaco; font-style: italic;">getDefaultProps</span>：只调用一次，实例之间共享引用，在里面定义默认属性（我们已经用.defaultProps设置）</span></div><div style="background-color: rgb(251, 250, 248); font-size: 12px;"><div><br/></div></div><div style="background-color: rgb(251, 250, 248); font-size: 12px;"><span style="font-size: 9pt; background-color: rgb(251, 250, 248); font-family: Monaco;"><span style="background-color: rgb(251, 250, 248); font-size: 9pt; font-family: Monaco; font-style: italic;">getInitialState</span>：初始化每个实例特有的状态，<span style="font-size: 9pt; background-color: rgb(251, 250, 248); font-family: Monaco;">在里面定义状态（我们用constructor定义状态）</span></span></div><div style="background-color: rgb(251, 250, 248); font-size: 12px;"><div><br/></div></div><div style="background-color: rgb(251, 250, 248); font-size: 12px;"><span style="font-size: 9pt;"><span style="font-size: 9pt; background-color: rgb(251, 250, 248); font-family: Monaco;">1、</span></span></div><div style="background-color: rgb(251, 250, 248); font-size: 12px;"><span style="font-size: 9pt; background-color: rgb(251, 250, 248); font-family: Monaco;"><span style="background-color: rgb(251, 250, 248); font-size: 9pt; font-family: Monaco; font-weight: bold;">componentWillMount：</span><span style="background-color: rgb(251, 250, 248); font-size: 9pt; font-family: Monaco; background-position: initial initial; background-repeat: initial initial;">（组件</span><span style="background-color: rgb(251, 250, 248); font-size: 9pt; font-family: Monaco; font-weight: bold;">将要挂载</span><span style="background-color: rgb(251, 250, 248); font-size: 9pt; font-family: Monaco; background-position: initial initial; background-repeat: initial initial;">到dom节点上）</span><span style="background-color: rgb(251, 250, 248); font-size: 9pt; font-family: Monaco; font-weight: bold;">render</span>之前最后一次修改状态的机会，做<span style="background-color: rgb(251, 250, 248); font-size: 9pt; font-family: Monaco; font-weight: bold;">数据请求</span></span></div><div style="background-color: rgb(251, 250, 248); font-size: 12px;"><br/></div><div style="background-color: rgb(251, 250, 248); font-size: 12px;"><span style="font-size: 9pt; background-color: rgb(251, 250, 248); font-family: Monaco;">2、</span></div><div style="font-size: 12px;"><span style="background-color: rgb(251, 250, 248); font-size: 9pt; font-family: Monaco; font-weight: bold;">render</span><span style="background-color: rgb(251, 250, 248); font-size: 9pt; font-family: Monaco;">：</span><span style="font-size: 9pt; background-color: rgb(251, 250, 248); font-family: Monaco; background-position: initial initial; background-repeat: initial initial;">（开始</span><span style="font-size: 9pt; background-color: rgb(251, 250, 248); font-family: Monaco; font-weight: bold;">渲染</span><span style="font-size: 9pt; background-color: rgb(251, 250, 248); font-family: Monaco; background-position: initial initial; background-repeat: initial initial;">，真实dom还没生成，只生成虚拟dom）</span><span style="background-color: rgb(251, 250, 248); font-size: 9pt; font-family: Monaco; font-weight: bold;">只</span><span style="background-color: rgb(251, 250, 248); font-size: 9pt; font-family: Monaco;">能访问</span><span style="background-color: rgb(251, 250, 248); font-size: 9pt; font-family: Monaco; font-weight: bold;">this.props</span><span style="background-color: rgb(251, 250, 248); font-size: 9pt; font-family: Monaco;">和</span><span style="background-color: rgb(251, 250, 248); font-size: 9pt; font-family: Monaco; font-weight: bold;">this.state</span><span style="font-size: 9pt;"><span style="background-color: rgb(251, 250, 248); font-size: 9pt; font-family: Monaco;">，</span><span style="font-size: 9pt; font-family: Monaco; font-weight: bold; background-color: rgb(255, 250, 165); background-position: initial initial; background-repeat: initial initial;-evernote-highlight:true;">不允许修改状态和DOM输出（死循环了）</span></span></div><div style="background-color: rgb(251, 250, 248); font-size: 12px;"><div><br/></div></div><div style="background-color: rgb(251, 250, 248); font-size: 12px;"><span style="font-size: 9pt; background-color: rgb(251, 250, 248); font-family: Monaco;">3、</span></div><div style="background-color: rgb(251, 250, 248); font-size: 12px;"><div><span style="background-color: rgb(251, 250, 248); font-size: 9pt; font-family: Monaco; font-weight: bold;">componentDidMount</span><span style="background-color: rgb(251, 250, 248); font-size: 9pt; font-family: Monaco;">：</span><span style="background-color: rgb(251, 250, 248); font-size: 9pt; font-family: Monaco; background-position: initial initial; background-repeat: initial initial;">（组件</span><span style="background-color: rgb(251, 250, 248); font-size: 9pt; font-family: Monaco; font-weight: bold;">已经挂载</span><span style="background-color: rgb(251, 250, 248); font-size: 9pt; font-family: Monaco; background-position: initial initial; background-repeat: initial initial;">到dom节点上）</span><span style="background-color: rgb(251, 250, 248); font-size: 9pt; font-family: Monaco;">成功render并渲染完成真实DOM之后触发，可以修改DOM （<b>用于ajax \ 事件绑定 \ 开启定时器</b>）</span></div></div><div style="background-color: rgb(251, 250, 248); font-size: 12px;"><br/></div><div style="background-color: rgb(251, 250, 248); font-size: 12px;"><span style="background-color: rgb(251, 250, 248); font-size: 12px;"><img src="2.0 生命周期 请求数据 fetch_files/Image [2].png" type="image/png" style="font-size: 9pt; height: auto;"/></span></div><div style="background-color: rgb(251, 250, 248); font-size: 12px;"><br/></div><div style="background-color: rgb(251, 250, 248); font-size: 12px;"><br/></div><div style="background-color: rgb(251, 250, 248); font-size: 12px;"><hr/><div><br/></div></div><div style="background-color: rgb(251, 250, 248); font-size: 12px;"><br/></div><div style="background-color: rgb(251, 250, 248); font-size: 12px;"><span style="background-color: rgb(251, 250, 248); font-size: 12px;"><img src="2.0 生命周期 请求数据 fetch_files/Image [3].png" type="image/png" style="height: auto;"/></span></div><div style="background-color: rgb(251, 250, 248); font-size: 12px;"><div><br/></div></div><div style="background-color: rgb(251, 250, 248); font-size: 12px;"><span style="font-size: 9pt; background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 9pt; font-weight: bold;">运行中</span>阶段可以使用的函数：    </span></div><div style="background-color: rgb(251, 250, 248); font-size: 12px;"><span style="font-size: 9pt; background-color: rgb(251, 250, 248);">父组件修改了子组件的属性或者组件自身状态发生改变时，才能触发</span></div><div style="background-color: rgb(251, 250, 248); font-size: 12px;"><div><br/></div></div><div style="background-color: rgb(251, 250, 248); font-size: 12px;"><span style="font-size: 9pt; background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 9pt; font-weight: bold;">有顺序</span>的：</span></div><div style="background-color: rgb(251, 250, 248); font-size: 12px;"><div><span style="background-color: rgb(251, 250, 248); font-size: 12px;">1、（不一定调用）</span></div></div><div style="background-color: rgb(251, 250, 248); font-size: 12px;"><span style="background-color: rgb(251, 250, 248); font-size: 9pt; font-weight: bold;">componentWillReceiveProps</span><span style="background-color: rgb(251, 250, 248); font-size: 9pt;">：</span><span style="background-color: rgb(251, 250, 248); font-size: 9pt; font-weight: bold;">父</span><span style="background-color: rgb(251, 250, 248); font-size: 9pt;">组件</span><span style="background-color: rgb(251, 250, 248); font-size: 9pt; font-weight: bold;">修改属性</span><span style="background-color: rgb(251, 250, 248); font-size: 9pt; font-weight: bold; text-decoration: underline;">触发</span><span style="background-color: rgb(251, 250, 248); font-size: 9pt; font-weight: bold;">时</span><span style="background-color: rgb(251, 250, 248); font-size: 9pt;">，可以修改自身新属性、修改状态</span></div><div style="background-color: rgb(251, 250, 248); font-size: 12px;"><div><br/></div></div><div style="background-color: rgb(251, 250, 248); font-size: 12px;"><div><span style="background-color: rgb(251, 250, 248); font-size: 12px;">2、</span><span style="font-size: 9pt; background-color: rgb(251, 250, 248);">（不一定调用）</span></div></div><div style="background-color: rgb(251, 250, 248); font-size: 12px;"><span style="background-color: rgb(251, 250, 248); font-size: 9pt; font-weight: bold;">shouldComponentUpdate</span><span style="background-color: rgb(251, 250, 248); font-size: 9pt;">：（组件是否要</span><span style="background-color: rgb(251, 250, 248); font-size: 9pt; font-weight: bold;">更新</span><span style="background-color: rgb(251, 250, 248); font-size: 9pt;">，更新状态时调用，默认return true）</span><span style="background-color: rgb(251, 250, 248); font-size: 9pt; font-weight: bold;">返回false会阻止render调用</span> <span style="background-color: rgb(251, 250, 248); font-size: 9pt;">,</span> <span style="background-color: rgb(251, 250, 248); font-size: 9pt; font-weight: bold;">优化组件性能</span></div><div style="background-color: rgb(251, 250, 248); font-size: 12px;"><div><br/></div></div><div style="background-color: rgb(251, 250, 248); font-size: 12px;"><div><span style="background-color: rgb(251, 250, 248); font-size: 12px;">3、or</span><span style="background-color: rgb(251, 250, 248); font-size: 12px; font-style: italic;">1、</span></div></div><div style="background-color: rgb(251, 250, 248); font-size: 12px;"><span style="background-color: rgb(251, 250, 248); font-size: 9pt; font-weight: bold;"><font style="color: rgb(123, 0, 61);">componentWillUpdate</font></span><span style="background-color: rgb(251, 250, 248); font-size: 9pt;">：( 将要更新，</span><span style="background-color: rgb(251, 250, 248); font-size: 9pt; text-decoration: underline;">更新状态就调用 </span><span style="background-color: rgb(251, 250, 248); font-size: 9pt;">)只能访问，<span style="background-color: rgb(251, 250, 248); font-size: 9pt; font-weight: bold;"><font style="color: rgb(123, 0, 61);">不能修改</font>属性和状态</span></span></div><div style="background-color: rgb(251, 250, 248); font-size: 12px;"><div><br/></div></div><div style="background-color: rgb(251, 250, 248); font-size: 12px;"><span style="background-color: rgb(251, 250, 248); font-size: 12px;">4、or2</span><span style="background-color: rgb(251, 250, 248); font-size: 12px; font-style: italic;">、</span></div><div style="background-color: rgb(251, 250, 248); font-size: 12px;"><span style="background-color: rgb(251, 250, 248); font-size: 9pt; font-weight: bold;"><font style="color: rgb(123, 0, 61);">render</font></span><span style="background-color: rgb(251, 250, 248); font-size: 9pt;">： </span><span style="background-color: rgb(251, 250, 248); font-size: 9pt;">( 渲染</span><span style="font-size: 9pt; background-color: rgb(251, 250, 248);">，<span style="background-color: rgb(251, 250, 248); font-size: 9pt; text-decoration: underline;">更新状态</span><span style="font-size: 9pt; background-color: rgb(251, 250, 248); text-decoration: underline;">就</span><span style="background-color: rgb(251, 250, 248); font-size: 9pt; text-decoration: underline;">调用 </span></span><span style="background-color: rgb(251, 250, 248); font-size: 9pt;">)</span><span style="background-color: rgb(251, 250, 248); font-size: 9pt; font-weight: bold;">只</span><span style="background-color: rgb(251, 250, 248); font-size: 9pt;">能访问</span><span style="background-color: rgb(251, 250, 248); font-size: 9pt; font-weight: bold;">this.props和this.state</span><span style="background-color: rgb(251, 250, 248); font-size: 9pt;">，<b><font style="color: rgb(123, 0, 61);">不允许修改</font></b>状态和DOM输出</span></div><div style="background-color: rgb(251, 250, 248); font-size: 12px;"><div><br/></div></div><div style="background-color: rgb(251, 250, 248); font-size: 12px;"><div><span style="background-color: rgb(251, 250, 248); font-size: 12px;">5、or</span><span style="background-color: rgb(251, 250, 248); font-size: 12px; font-style: italic;">3、</span></div></div><div style="background-color: rgb(251, 250, 248); font-size: 12px;"><div><span style="background-color: rgb(251, 250, 248); font-size: 9pt; font-weight: bold;">componentDidUpdate</span><span style="background-color: rgb(251, 250, 248); font-size: 9pt;">：</span><span style="background-color: rgb(251, 250, 248); font-size: 9pt;">( 已经更新</span><span style="font-size: 9pt; background-color: rgb(251, 250, 248);">，<span style="background-color: rgb(251, 250, 248); font-size: 9pt; text-decoration: underline;">更新状态</span><span style="font-size: 9pt; background-color: rgb(251, 250, 248); text-decoration: underline;">就</span><span style="background-color: rgb(251, 250, 248); font-size: 9pt; text-decoration: underline;">调用 </span></span><span style="background-color: rgb(251, 250, 248); font-size: 9pt;">)</span><span style="background-color: rgb(251, 250, 248); font-size: 9pt;"><span style="background-color: rgb(251, 250, 248); font-size: 9pt; font-weight: bold;">可以修改DOM</span></span></div><div><br/></div><div><br/></div><div><span style="font-size: 9pt;"><span style="font-size: 9pt; background-color: rgb(251, 250, 248);">componentWillReceiveProps </span><span style="background-color: rgb(251, 250, 248); font-size: 9pt; font-weight: bold;">修改自身新属性、修改状态：</span></span></div></div><div style="background-color: rgb(251, 250, 248); font-size: 12px;"><div><span style="background-color: rgb(251, 250, 248); font-size: 12px;"><img src="2.0 生命周期 请求数据 fetch_files/Image [4].png" type="image/png" style="font-size: 9pt; height: auto;"/></span></div></div><div style="background-color: rgb(251, 250, 248); font-size: 12px;"><br/></div><div style="background-color: rgb(251, 250, 248); font-size: 12px;"><br/></div><div style="background-color: rgb(251, 250, 248); font-size: 12px;"><span style="background-color: rgb(251, 250, 248); font-size: 12px;"><img src="2.0 生命周期 请求数据 fetch_files/Image [5].png" type="image/png" style="height: auto;"/></span></div><div style="background-color: rgb(251, 250, 248); font-size: 12px;"><span style="background-color: rgb(251, 250, 248); font-size: 12px;"><img src="2.0 生命周期 请求数据 fetch_files/Image [6].png" type="image/png" style="font-size: 9pt; height: auto;"/></span></div><div style="background-color: rgb(251, 250, 248); font-size: 12px;"><br/></div><div style="background-color: rgb(251, 250, 248); font-size: 12px;"><hr/><div><br/></div><div><span style="background-color: rgb(251, 250, 248); font-size: 12px;"><img src="2.0 生命周期 请求数据 fetch_files/Image [7].png" type="image/png" style="font-size: 9pt; height: auto;"/></span></div><div><br/></div><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248);">销毁阶段可以使用的函数：</span></div><div><span style="background-color: rgb(251, 250, 248); font-size: 9pt; font-weight: bold;">componentWillUnmount</span><span style="background-color: rgb(251, 250, 248); font-size: 9pt;">：在</span><span style="background-color: rgb(251, 250, 248); font-size: 9pt; font-weight: bold;">删除</span><span style="background-color: rgb(251, 250, 248); font-size: 9pt;">组件之前进行清理操作，比如计时器、事件监听器、事件解绑</span></div></div><div style="background-color: rgb(251, 250, 248); font-size: 12px;"><br/></div><div style="background-color: rgb(251, 250, 248); font-size: 12px;"><div><span style="background-color: rgb(251, 250, 248); font-size: 12px;"><img src="2.0 生命周期 请求数据 fetch_files/Image [8].png" type="image/png" style="font-size: 9pt; height: auto;"/></span></div></div><div style="background-color: rgb(251, 250, 248); font-size: 12px;"><div><span style="background-color: rgb(251, 250, 248); font-size: 12px;"><img src="2.0 生命周期 请求数据 fetch_files/Image [9].png" type="image/png" style="font-size: 9pt; height: auto;"/></span></div></div></div><div><br/></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-size: 12px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902);"><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">//请求数据应用</span></div><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">import React from &quot;react&quot;;</span></div><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">import ReactDOM from &quot;react-dom&quot;;</span></div><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">import axios from &quot;axios&quot;;     <span style="background-color: rgb(255, 250, 165); font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;-evernote-highlight:true;"> //基于promise 一个库 要npm install axios --save</span></span></div><div><br/></div><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">class Hello  extends React.Component{</span></div><div><br/></div><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">    constructor(props){</span></div><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">        super(props);</span></div><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">        this.state={</span></div><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">            name:&quot;默认值&quot;</span></div><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">        }</span></div><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">    }</span></div><div><br/></div><div><span style="background-color: rgb(251, 250, 248); font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">    </span><span style="background-color: rgb(251, 250, 248); font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco; font-weight: bold;">componentWillMount</span><span style="background-color: rgb(251, 250, 248); font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">(callback){</span></div><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">        // fetch(&quot;</span><a href="http://datainfo.duapp.com/shopdata/getclass.php%22" style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">http://datainfo.duapp.com/shopdata/getclass.php&quot;</a><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">;)</span></div><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">        // .then(res=&gt;res.json())//拿到是状态码， 以及响应头信息。 res.text 返回的是字符串</span></div><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">        // //res.json();返回的就是对象</span></div><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">        // .then(res=&gt;{</span></div><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">        //     console.log(res);</span></div><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">        // })</span></div><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">        <span style="background-color: rgb(251, 250, 248); font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco; font-weight: bold;">axios.get(&quot;/json/data.json&quot;).then(res=&gt;{</span></span></div><div><span style="font-size: 9pt;"><span style="background-color: rgb(251, 250, 248); font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco; font-weight: bold;">            console.log(res.data);</span></span></div><div><span style="font-size: 9pt;"><span style="background-color: rgb(251, 250, 248); font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco; font-weight: bold;">            this.setState({</span></span></div><div><span style="font-size: 9pt;"><span style="background-color: rgb(251, 250, 248); font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco; font-weight: bold;">                name:res.data.name</span></span></div><div><span style="font-size: 9pt;"><span style="background-color: rgb(251, 250, 248); font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco; font-weight: bold;">            })</span></span></div><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">        })</span></div><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">        // Promise.all([axios.get(&quot;/json/data.json&quot;),get2()]).then <span style="background-color: rgb(255, 250, 165); font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;-evernote-highlight:true;">多个接口</span></span></div><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">    <span style="background-color: rgb(251, 250, 248); font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco; font-weight: bold;">}</span></span></div><div><br/></div><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">    render(){</span></div><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">        return &lt;div&gt;</span></div><div><span style="background-color: rgb(251, 250, 248); font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">            Hello--{ </span><span style="background-color: rgb(251, 250, 248); font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco; font-weight: bold;">this.state.name </span><span style="background-color: rgb(251, 250, 248); font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">}</span></div><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">        &lt;/div&gt;</span></div><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">    }</span></div><div><br/></div><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">}</span></div><div><br/></div><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">ReactDOM.render(&lt;Hello/&gt;,document.getElementById(&quot;box&quot;));</span></div><div><br/></div></div><div><br/></div><div><hr/></div><div>fetch :  w3c新定义的标准  基于promise </div><div><br/></div><div>    why:</div><div>    XMLHttpRequest 是一个设计粗糙的 API，配置和调用方式非常混乱，而且基于事件的异步模型写起来不友好。</div><div><br/></div><div>    兼容性不好 <a href="http://caniuse.com/">caniuse.com</a></div><div>    使用 =&gt;polyfill : <a href="https://github.com/camsong/fetch-ie8">https://github.com/camsong/fetch-ie8</a></div><div><br/></div><div><img src="2.0 生命周期 请求数据 fetch_files/Image [10].png" type="image/png" style="height: auto;"/></div><div><img src="2.0 生命周期 请求数据 fetch_files/Image [11].png" type="image/png" style="height: auto;"/></div><div><img src="2.0 生命周期 请求数据 fetch_files/Image [12].png" type="image/png" style="height: auto;"/></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-size: 12px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902);"><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">//get</span></div><div><br/></div><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">fetch(&quot;**&quot;).then(res=&gt;res.</span><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-weight: bold;">json</span><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">( )).then(res=&gt;{</span></div><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">    console.log(res);</span></div><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">})</span></div><div><br/></div><div><br/></div><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">fetch(&quot;**&quot;).then(res=&gt;res.</span><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-weight: bold;">text</span><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">( )).then(res=&gt;{</span></div><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">    console.log(res);</span></div><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">})</span></div></div><div>    </div><div style="box-sizing: border-box; padding: 8px; font-size: 12px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902);"><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">//post</span></div><div><br/></div><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">fetch(&quot;**&quot;,{</span></div><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">    method:'post',</span></div><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">    headers: {</span></div><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">        &quot;Content-Type&quot;: &quot;</span><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-weight: bold;">application/x-www-form-urlencoded</span><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">&quot;</span></div><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">    },</span></div><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">    </span><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-weight: bold;">body: &quot;name=kerwin&amp;age=100&quot;</span></div><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">}).then(res=&gt;res.json()).then(res=&gt;{</span></div><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">    console.log(res)</span></div><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">});</span></div><div><br/></div><div><br/></div><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">fetch(&quot;/users&quot;,{</span></div><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">    method:'post',</span></div><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">    headers: {</span></div><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">        &quot;Content-Type&quot;: &quot;</span><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-weight: bold;">application/json</span><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">&quot;</span></div><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">    },</span></div><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">    </span><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-weight: bold;">body: JSON.stringify({</span></div><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-weight: bold;">        name:&quot;kerwin&quot;,</span></div><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-weight: bold;">        age:100</span></div><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-weight: bold;">    })</span></div><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">}).then(res=&gt;res.json()).then(res=&gt;{</span></div><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">    console.log(res)</span></div><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">});</span></div></div><div>       </div><div> 注意：</div><div>        Fetch 请求默认是<span style="font-weight: bold;">不带 cookie</span> 的，需要设置 fetch(url, {credentials: 'include'})</div><div>        fetch和axios都不支持jsonp</div><div>        如果想fetch支持jsonp<img src="2.0 生命周期 请求数据 fetch_files/Image [13].png" type="image/png" style="height: auto;"/></div><div><hr/><div><br/></div></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-size: 12px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902);"><div><br/></div><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">    </span><span style="font-size: 9pt;"><span style="background-color: rgb(251, 250, 248); font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco; font-weight: bold;">componentWillMount</span></span><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">(callback){</span></div><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">        // fetch(&quot;</span><a href="http://datainfo.duapp.com/shopdata/getclass.php%22" style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">http://datainfo.duapp.com/shopdata/getclass.php&quot;</a><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">;)</span></div><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">        // .then(res=&gt;res.json())//拿到是状态码， 以及响应头信息。 res.text 返回的是字符串</span></div><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">        // //res.json();返回的就是对象</span></div><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">        // .then(res=&gt;{</span></div><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">        //     console.log(res);</span></div><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">        // })</span></div><div><span style="font-size: 9pt;"><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">        fetch(&quot;/json/data.json?name=kerwin&quot;).then(res=&gt;{</span></span></div><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">            console.log(res);</span></div><div><span style="background-color: rgb(251, 250, 248); font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">            return</span> <span style="background-color: rgb(251, 250, 248); font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco; font-weight: bold;">res.json</span><span style="background-color: rgb(251, 250, 248); font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">( )   </span><span style="background-color: rgb(255, 250, 165); font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;-evernote-highlight:true;">//json解析</span></div><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">        }).then(res=&gt;{</span></div><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">            console.log(res);</span></div><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">        })</span></div><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">    </span><span style="font-size: 9pt;"><span style="background-color: rgb(251, 250, 248); font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco; font-weight: bold;">}</span></span></div></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div></span>
</div></body></html> 