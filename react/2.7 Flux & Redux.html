<html>
<head>
  <title>2.7 Flux &amp; Redux</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/303788 (zh-CN, DDL); Windows/6.1.7601 Service Pack 1 (Win32);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="778"/>
<h1>2.7 Flux &amp; Redux</h1>

<div>
<span><div>    <span style="font-weight: bold;">Flux</span> 是一种<span style="font-weight: bold;">架构思想</span>，<b>专门解决软件的结构问题</b>。它跟MVC架构是同一类东西，但是更加简单和清晰。 解耦</div><div>    Flux存在多种实现(至少15种)</div><div><br/></div><div><a href="https://github.com/voronianski/flux-comparison">https://github.com/voronianski/flux-comparison</a></div><div><br/></div><div>    <span style="font-weight: bold;">Facebook  Flux</span>是用来构建客户端Web应用的应用架构。它利用单向数据流的方式来组合React中的视图组件。它<span style="font-weight: bold;">更像一个</span><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;"><span style="background-color: rgb(255, 250, 165); font-weight: bold;-evernote-highlight:true;">模式</span></span><span style="font-style: italic; font-weight: bold;"> </span><span style="font-weight: bold;">而不是一个正式的框架</span>，开发者不需要太多的新代码就可以快速的上手Flux。</div><div><br/></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-size: 12px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902);"><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-weight: bold;">流程：</span></div><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;"><b>1、用户访问 <span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">View</span></b></span></div><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;"><b>2、View 发出用户的 Action</b></span></div><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;"><b>3、Dispatcher 收到 Action，要求 Store 进行相应的更新</b></span></div><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;"><b>4、Store 更新后，发出一个&quot;change&quot;事件</b></span></div><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;"><b>5、View 收到&quot;change&quot;事件后，更新页面</b></span></div><div><br/></div><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><img src="2.7 Flux & Redux_files/Image.png" type="image/png"/></span></div><div><br/></div><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-weight: bold;">四个组成：</span></div><div><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco;">View： 视图层</span></div><div><span style="background-color: rgb(251, 250, 248); font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">Action（</span><span style="background-color: rgb(251, 250, 248); font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco; font-style: italic;">动作 </span><span style="background-color: rgb(251, 250, 248); font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">）：视图层发出的消息（比如click）</span></div><div><span style="background-color: rgb(251, 250, 248); font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">Dispatcher（</span><span style="background-color: rgb(251, 250, 248); font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco; font-style: italic;">派发器 </span><span style="background-color: rgb(251, 250, 248); font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">）：用来接收Actions、执行回调函数</span></div><div><span style="background-color: rgb(251, 250, 248); font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">Store（</span><span style="background-color: rgb(251, 250, 248); font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco; font-style: italic;">数据层 </span><span style="background-color: rgb(251, 250, 248); font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">）：用来存放应用的状态，一旦发生变动，就提醒Views要更新</span></div></div><div><br/></div><div><img src="2.7 Flux & Redux_files/Image [1].png" type="image/png"/></div><div><br/></div><div><img src="2.7 Flux & Redux_files/Image [2].png" type="image/png"/></div><div><br/></div><div><img src="2.7 Flux & Redux_files/Image [3].png" type="image/png"/></div><div><br/></div><div><img src="2.7 Flux & Redux_files/Image [4].png" type="image/png"/></div><div><br/></div><div><img src="2.7 Flux & Redux_files/Image [5].png" type="image/png"/></div><div><br/></div><div><br/></div><div><br/></div><div><hr/><div><br/></div></div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">    </span><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco; font-weight: bold;">Redux</span><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">对于JavaScript应用而言是一个</span><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco; font-weight: bold;">可预测状态的容器</span><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">。换言之，它是一个</span><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco; font-weight: bold;">应用数据流框架</span><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">，而不是传统的像underscore.js或者AngularJs那样的库或者框架。</span></div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;"><br/></span></div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">    Redux最主要是用作应用状态的管理。简言之，</span><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco; font-weight: bold;">Redux</span><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">用一个单独的</span><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco; font-weight: bold;">常量状态树</span><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">（state对象）保存这一整个应用的状态，这个对象</span><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco; font-weight: bold;">不能直接被改变</span><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">。当一些</span><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco; font-weight: bold;">数据变化</span><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">了，一个新的对象就会被</span><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco; font-weight: bold;">创建</span><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">（使用actions 和 reducers），这样就可以</span><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco; font-weight: bold;">进行数据追踪</span><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">，实现时光旅行。</span></div><div><br/></div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">    Redux 算是对于 flux 的完美实现， 只有</span><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco; font-weight: bold;">几kb</span><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">，</span><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco; font-weight: bold;">跟react 没有关系</span><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">，但</span><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco; font-weight: bold;">搭配</span><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">起来简直</span><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco; font-weight: bold;">完美</span><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">。</span></div><div><br/></div><div><br/></div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">设计和使用的</span><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco; font-weight: bold;">三大原则</span><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">：</span></div><div><span style="font-size: 9pt;"><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco; font-weight: bold;">    state 以单一对象存储在 store 对象中</span></span></div><div><span style="font-size: 9pt;"><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco; font-weight: bold;">    state 只读（每次都返回一个新的对象）</span></span></div><div><span style="font-size: 9pt;"><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco; font-weight: bold;">    使用纯函数 reducer 执行 state 更新</span></span></div><div><span style="font-size: 9pt;"><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco; font-weight: bold;"><br/></span></span></div><div><span style="font-size: 9pt;"><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco; font-weight: bold;"><br/></span></span></div><div><span style="font-size: 9pt;"><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco; font-weight: bold;">Redux工作流程：</span></span></div><div><br/></div><div><img src="2.7 Flux & Redux_files/Image [6].png" type="image/png"/></div><div><br/></div><div><hr/></div><div><br/></div><div><img src="2.7 Flux & Redux_files/Image [7].png" type="image/png"/></div><div><hr/></div><div><img src="2.7 Flux & Redux_files/Image [8].png" type="image/png"/></div><div><br/></div><div><hr/></div><div><img src="2.7 Flux & Redux_files/Image [9].png" type="image/png"/></div><div><br/></div><div><br/></div><div>使用react-redux组件</div><div><a href="https://github.com/reactjs/react-redux">https://github.com/reactjs/react-redux</a></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div></span>
</div></body></html> 