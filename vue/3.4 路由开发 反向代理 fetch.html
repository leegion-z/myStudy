<html>
<head>
  <title>3.4 路由开发 反向代理 fetch</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/303788 (zh-CN, DDL); Windows/6.1.7601 Service Pack 1 (Win32);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="489"/>
<h1>3.4 路由开发 反向代理 fetch</h1>

<div>
<span><div>根据不同的路径 返回输出不同的组件</div><div><br/></div><div><img src="3.4 路由开发 反向代理 fetch_files/Image.png" type="image/png"/></div><div><br/></div><div><img src="3.4 路由开发 反向代理 fetch_files/Image [1].png" type="image/png"/></div><div><br/></div><div><br/></div><div>路由容器：</div><div><img src="3.4 路由开发 反向代理 fetch_files/Image [2].png" type="image/png"/></div><div><br/></div><div><br/></div><div>页面跳转：</div><div><img src="3.4 路由开发 反向代理 fetch_files/Image [3].png" type="image/png"/></div><div><br/></div><div><br/></div><div>声明式导航：router-link;</div><div>编程式导航：</div><div><img src="3.4 路由开发 反向代理 fetch_files/Image [4].png" type="image/png"/></div><div><br/></div><div><img src="3.4 路由开发 反向代理 fetch_files/Image [5].png" type="image/png"/></div><div><br/></div><div><img src="3.4 路由开发 反向代理 fetch_files/Image [6].png" type="image/png"/></div><div><br/></div><div><img src="3.4 路由开发 反向代理 fetch_files/Image [7].png" type="image/png"/></div><div><br/></div><div>动态路由：</div><div><img src="3.4 路由开发 反向代理 fetch_files/Image [8].png" type="image/png"/></div><div><br/></div><div><img src="3.4 路由开发 反向代理 fetch_files/Image [9].png" type="image/png"/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div>history模式</div><div><img src="3.4 路由开发 反向代理 fetch_files/Image [10].png" type="image/png"/></div><div><br/></div><div><br/></div><div>1.安装node-sass sass-loader 进行sass开发</div><div>scss-loader :   必须cnpm</div><div><img src="3.4 路由开发 反向代理 fetch_files/Image [11].png" type="image/png"/></div><div><br/></div><div><br/></div><div>2.配置<span style="font-weight: bold;">反向代理</span></div><div>    </div><div style="box-sizing: border-box; padding: 8px; font-size: 12px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902);"><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">proxyTable: {</span></div><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">    '/v4/api': {</span></div><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">        target: '</span><a href="https://m.maizuo.com'/" style="background-color: rgb(251, 250, 248); font-size: 12px; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">https://m.maizuo.com'</a><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">;;,</span></div><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">        host: '</span><a href="http://m.maizuo.com/" style="background-color: rgb(251, 250, 248); font-size: 12px; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">m.maizuo.com</a><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">',</span></div><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">        changeOrigin:true,</span></div><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">        // pathRewrite: {</span></div><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">            //'^/v4/api': '/v4/api'</span></div><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">        //   }</span></div><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">    }</span></div><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">}</span></div></div><div><br/></div><div><br/></div><div><br/></div><div>3.<span style="line-height: 1.45;">fetch :  w3c新定义的标准</span></div><div><br/></div><div>    why:</div><div>    <span style="font-style: italic; font-weight: bold;">XMLHttpRequest 是一个设计粗糙的 API，配置和调用方式非常混乱，</span><span style="font-style: italic; font-weight: bold; line-height: 1.45;">而且基于事件的异步模型写起来不友好。</span></div><div><br/></div><div>    <span style="font-weight: bold;">兼容性不好 caniuse.com</span></div><div>    使用 =&gt;<span style="font-weight: bold;">polyfill</span> : <a href="https://github.com/camsong/fetch-ie8" style="line-height: 1.45;">https://github.com/camsong/fetch-ie8</a></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-size: 12px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902);"><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">//get</span></div><div><hr/><div><br/></div></div><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">fetch(&quot;**&quot;).then(res=&gt;res.</span><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-weight: bold;">json</span><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">( )).then(res=&gt;{</span></div><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">    console.log(res);</span></div><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">})</span></div><div><br/></div><div><hr/><div><br/></div></div><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">fetch(&quot;**&quot;).then(res=&gt;res.</span><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-weight: bold;">text</span><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">( )).then(res=&gt;{</span></div><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">    console.log(res);</span></div><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">})</span></div></div><div>    </div><div style="box-sizing: border-box; padding: 8px; font-size: 12px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902);"><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">//post</span></div><div><hr/><div><br/></div></div><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">fetch(&quot;**&quot;,{</span></div><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">    method:'post',</span></div><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">    headers: {</span></div><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">        &quot;Content-Type&quot;: &quot;</span><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-weight: bold;">application/x-www-form-urlencoded&quot;</span></div><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">    },</span></div><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">    body: &quot;name=kerwin&amp;age=100&quot;</span></div><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">}).then(res=&gt;res.json()).then(res=&gt;{</span></div><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">    console.log(res)</span></div><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">});</span></div><div><br/></div><div><hr/></div><div><br/></div><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">fetch(&quot;/users&quot;,{</span></div><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">    method:'post',</span></div><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">    headers: {</span></div><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">        &quot;Content-Type&quot;: &quot;</span><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-weight: bold;">application/json</span><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">&quot;</span></div><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">    },</span></div><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">    body: JSON.stringify({</span></div><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">        name:&quot;kerwin&quot;,</span></div><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">        age:100</span></div><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">    })</span></div><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">}).then(res=&gt;res.json()).then(res=&gt;{</span></div><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">    console.log(res)</span></div><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">});</span></div></div><div>       </div><div> <span style="font-weight: bold;">注意</span>：</div><div>        Fetch 请求默认是<span style="font-weight: bold;">不带 cookie</span> 的，想带需要设置 <span style="font-weight: bold;">fetch(url, {credentials: 'include'})</span></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-size: 12px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902);"><div><span style="font-size: 10.5pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: 'Microsoft YaHei Light';">关于</span><span style="font-size: 10.5pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: 'Microsoft YaHei Light';">fetch跨域做了什么配置</span></div><div style="text-align: left; margin-top: 1em; margin-bottom: 1em;"><span style="font-size: 10.5pt; background-color: rgb(255, 255, 0); color: rgb(255, 0, 0); font-family: 'Microsoft YaHei Light'; background-position: initial initial; background-repeat: initial initial;">(可以正常提交数据，但是无法得到返回)</span></div><div style="text-align: left; margin-top: 1em; margin-bottom: 1em;"><span style="background-color: rgb(251, 250, 248); color: rgb(255, 0, 0); font-family: 'Microsoft YaHei Light'; font-size: 10.5pt;">fetch(&quot;</span><a href="http://localhost:3000/eleapi/menu_restaurant%22" style="background-color: rgb(251, 250, 248); font-family: 'Microsoft YaHei Light'; font-size: 10.5pt;">http://localhost:3000/eleapi/menu_restaurant&quot;</a><span style="background-color: rgb(251, 250, 248); color: rgb(255, 0, 0); font-family: 'Microsoft YaHei Light'; font-size: 10.5pt;">;,{</span></div><div style="text-align: left; margin-top: 1em; margin-bottom: 1em;"><span style="font-size: 10.5pt; background-color: rgb(251, 250, 248); color: rgb(255, 0, 0); font-family: 'Microsoft YaHei Light';">                method:'post',</span></div><div style="text-align: left; margin-top: 1em; margin-bottom: 1em;"><span style="font-size: 10.5pt; background-color: rgb(251, 250, 248); color: rgb(255, 0, 0); font-family: 'Microsoft YaHei Light';">                </span><span style="font-size: 10.5pt; background-color: rgb(255, 255, 0); color: rgb(255, 0, 0); font-family: 'Microsoft YaHei Light'; background-position: initial initial; background-repeat: initial initial;">mode:&quot;no-cors&quot;,</span></div><div style="text-align: left; margin-top: 1em; margin-bottom: 1em;"><span style="font-size: 10.5pt; background-color: rgb(251, 250, 248); color: rgb(255, 0, 0); font-family: 'Microsoft YaHei Light';">                headers: {</span></div><div style="text-align: left; margin-top: 1em; margin-bottom: 1em;"><span style="font-size: 10.5pt; background-color: rgb(251, 250, 248); color: rgb(255, 0, 0); font-family: 'Microsoft YaHei Light';">                    &quot;Content-Type&quot;: &quot;application/x-www-form-urlencoded&quot;</span></div><div style="text-align: left; margin-top: 1em; margin-bottom: 1em;"><span style="font-size: 10.5pt; background-color: rgb(251, 250, 248); color: rgb(255, 0, 0); font-family: 'Microsoft YaHei Light';">                },</span></div><div style="text-align: left; margin-top: 1em; margin-bottom: 1em;"><span style="font-size: 10.5pt; background-color: rgb(251, 250, 248); color: rgb(255, 0, 0); font-family: 'Microsoft YaHei Light';">                body: &quot;firstName=kerwin&amp;favColor=blue&amp;password=11111&quot;</span></div><div style="text-align: left; margin-top: 1em; margin-bottom: 1em;"><span style="font-size: 10.5pt; background-color: rgb(251, 250, 248); color: rgb(255, 0, 0); font-family: 'Microsoft YaHei Light';">            }).then(function (response) {</span></div><div style="text-align: left; margin-top: 1em; margin-bottom: 1em;"><span style="font-size: 10.5pt; background-color: rgb(251, 250, 248); color: rgb(255, 0, 0); font-family: 'Microsoft YaHei Light';">                return response.json();//json对象</span></div><div style="text-align: left; margin-top: 1em; margin-bottom: 1em;"><span style="font-size: 10.5pt; background-color: rgb(251, 250, 248); color: rgb(255, 0, 0); font-family: 'Microsoft YaHei Light';">            }).then(function(result){</span></div><div style="text-align: left; margin-top: 1em; margin-bottom: 1em;"><span style="font-size: 10.5pt; background-color: rgb(251, 250, 248); color: rgb(255, 0, 0); font-family: 'Microsoft YaHei Light';">                console.log(result);</span></div><div><span style="font-size: 10.5pt; background-color: rgb(251, 250, 248); color: rgb(255, 0, 0); font-family: 'Microsoft YaHei Light';">            })</span></div></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div>4. axios</div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div></span>
</div></body></html> 