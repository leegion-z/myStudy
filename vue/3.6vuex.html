<html>
<head>
  <title>3.6vuex</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/303788 (zh-CN, DDL); Windows/6.1.7601 Service Pack 1 (Win32);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="655"/>
<h1>3.6vuex</h1>

<div>
<span><div>vue树：</div><div>vue树层结构 就是一个 二维数组 或者 高维数组的遍历 几个v-for嵌套</div><div><br/></div><div><br/></div><div>vuex:   </div><div> <a href="https://vuex.vuejs.org/zh-cn/">https://vuex.vuejs.org/zh-cn/</a></div><div><br/></div><div>全局状态数据管理</div><div>管理的数据是多页面需要共享的数据</div><div><div><img src="3.6vuex_files/Image.png" type="image/png" style="height: auto;"/></div><div><br/></div><div><br/></div><hr/><div><br/></div><div>vuex 使用：</div><div>一、同步：</div><div>1、安装</div><div>    <img src="3.6vuex_files/Image [1].png" type="image/png" style="height: auto;"/></div><div>2、新建 store文件夹 ==&gt;新建文件 index.js</div><div><img src="3.6vuex_files/Image [2].png" type="image/png" style="height: auto;"/></div><div><br/></div><div><br/></div><div>3、main.js 引入 注册</div><div><img src="3.6vuex_files/Image [3].png" type="image/png" style="height: auto;"/></div><div><img src="3.6vuex_files/Image [4].png" type="image/png" style="height: auto;"/></div><div><br/></div><div>4、储存 commit ==&gt;mutations</div><div><img src="3.6vuex_files/Image [5].png" type="image/png" style="height: auto;"/></div><div><br/></div><div>5、index.js添加 mutation 名字</div><div><br/></div><div>6、.vue 使用</div><div><img src="3.6vuex_files/Image [6].png" type="image/png" style="height: auto;"/></div><div><br/></div><div>更加规范的写法：</div><div><img src="3.6vuex_files/Image [7].png" type="image/png" style="height: auto;"/></div><div><br/></div><div>简洁写法：</div><div><img src="3.6vuex_files/Image [8].png" type="image/png" style="height: auto;"/></div><div><img src="3.6vuex_files/Image [9].png" type="image/png" style="height: auto;"/></div><div><br/></div><div><br/></div><div>1. Vuex 是一个专为 Vue.js 应用程序开发的<span style="font-weight: bold;">状态管理模式</span>。它采用集中式存储管理应用的所有组件的状态，并以相应的规则保证状态以一种可预测的方式发生变化</div><div>    </div><div>vuex分为几层（4层 ）？</div><div>Vue Components    Actions  Mutations  State</div><div><img src="3.6vuex_files/Image [10].png" type="image/png" style="height: auto;"/></div><div><br/></div><div><br/></div><div>    (1)<b>state</b>:单一状态树 ,每个应用将仅仅包含一个 store 实例。</div><div>        *this.$store.state.状态名字</div><div>        *...mapState([&quot;title&quot;])</div><div>    (2)getters:可以从store 中的 state 中派生出一些状态，getters的返回值会根据它的依赖被缓存起来，且只有当它的依赖值发生了改变才会被重新计算。</div><div>        *可以认为是 store 的计算属性</div><div>        *this.$store.getters.计算属性名字</div><div>        *...mapGetters([&quot;getFilms&quot;])</div><div>    (3)<b>mutations</b>：更改 Vuex 的 store 中的状态的唯一方法是提交 mutation。</div><div>            *常量的设计风格</div><div>            [SOME_MUTATION] (state) {</div><div>              // mutate state</div><div>            }</div><div>            *<b>必须是同步函数</b></div><div>            *this.$store.commit(&quot;type&quot;,&quot;payload&quot;);</div><div>    </div><div>    (4)<b>actions: 可以同步可以异步</b></div><div>        *Action 提交的是 mutation，而不是直接变更状态。</div><div>        *Action 可以包含任意异步操作。</div><div>        *this.$store.dispatch(&quot;type&quot;,&quot;payload&quot;)</div><div>        </div><div>    (5) 代码</div><div>            const store = new Vuex.Store({</div><div>              state: {</div><div>                count: 0</div><div>              },</div><div>              mutations: {</div><div>                increment (state ,payload) {</div><div>                    </div><div>                }</div><div>              },</div><div>              actions: {</div><div>                increment (context, payload) {</div><div>                  context.commit('increment')</div><div>                }</div><div>              }</div><div>            })</div><div><br/></div><div>2. 注意:</div></div><div>    (1)应用层级的状态应该集中到单个 store 对象中。</div><div>    (2)提交 mutation 是更改状态的唯一方法，并且这个过程是同步的,不能写异步方法。</div><div>    (3)异步逻辑都应该封装到 action 里面。</div><div>    </div><div>3. 借助 vue chrome devtools 进行状态追踪</div><div><img src="3.6vuex_files/Image [11].png" type="image/png" style="height: auto;"/></div><div><br/></div><div><hr/></div><div><hr/></div><div><br/></div><div><img src="3.6vuex_files/Image [12].png" type="image/png" style="height: auto;"/></div><div><br/></div><div><br/></div><div><hr/></div><div><br/></div><div>vuex/index.js</div><div><br/></div><div><br/></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>import Vue from 'vue'</div><div>import Vuex from 'vuex'</div><div><br/></div><div>Vue.use(Vuex);</div><div><br/></div><div>const state = {</div><div>    films: null,</div><div>    message: &quot;hello world&quot;</div><div>}</div><div><br/></div><div>const mutations = {</div><div>    setFilms: (state, filmsData)=&gt;{</div><div>        state.films = filmsData;</div><div>    }</div><div>}</div><div><br/></div><div>const actions = {</div><div>    setFilms: ({commit}, filmsData)=&gt;{</div><div>        commit('setFilms', filmsData)</div><div>    }</div><div>}</div><div><br/></div><div>const getters = {</div><div>    getTop3: function(state) {</div><div>        return state.films.slice(0, 3);</div><div>    }</div><div>}</div><div><br/></div><div>export default new <span style="color: rgb(227, 0, 0);">Vuex.Store(</span>{</div><div>    state,</div><div>    mutations,</div><div>    actions,</div><div>    getters</div><div>})</div></div><div><br/></div><div><br/></div><div><br/></div><div><hr/></div><div><br/></div><div>main.js</div><div><br/></div><div><img src="3.6vuex_files/Image [13].png" type="image/png" style="height: auto;"/></div><div><br/></div><div><hr/></div><div>xxx.vue</div><div><br/></div><div>//使用</div><div>{{$store.state.message}}</div><div><br/></div><div><br/></div><div>//修改</div><div>that.$store.dispatch(&quot;setFilms&quot;, res.data.data.films);</div><div><br/></div><div><hr/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div></span>
</div></body></html> 