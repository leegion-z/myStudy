<html>
<head>
  <title>2.4 MongoDB 术语 数据库操作 工具增删改查</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/303788 (zh-CN, DDL); Windows/6.1.7601 Service Pack 1 (Win32);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="937"/>
<h1>2.4 MongoDB 术语 数据库操作 工具增删改查</h1>

<div>
<span><div><br/></div><div>1、术语与概念</div><div><img src="2.4 MongoDB 术语 数据库操作 工具增删改查_files/Image.png" type="image/png"/></div><div><br/></div><div><span style="font-size: 11pt;">2、数据库命令</span></div><div><span style="font-size: 11pt;">        Help查看命令提示                </span></div><div><span style="font-size: 11pt;">                help    db.help()   db.test.help()  db.test.find().help()</span></div><div><span style="font-size: 11pt;">        创建/切换数据库</span></div><div><span style="font-size: 11pt;">                use music</span></div><div><span style="font-size: 11pt;">        查询数据库</span></div><div><span style="font-size: 11pt;">                show dbs</span></div><div><span style="font-size: 11pt;">        查看当前使用的数据库</span></div><div><span style="font-size: 11pt;">                db/db.getName()</span></div><div><span style="font-size: 11pt;">        显示当前DB状态    db.stats()</span></div><div><span style="font-size: 11pt;">        查看当前DB版本    db.version()</span></div><div><span style="font-size: 11pt;">        查看当前DB的链接机器地址       db.getMongo()</span></div><div><span style="font-size: 11pt;">        删除数据库         db.dropDatabase()</span></div><div><br/></div><div><br/></div><div><span style="font-size: 11pt;">3、<span style="font-size: 11pt;">Collection聚集集合操作</span></span></div><div><span style="font-size: 11pt;">        （1）创建一个聚集集合</span></div><div><span style="font-size: 11pt;">                </span><span style="font-size: 11pt; background-color: rgb(255, 250, 165);-evernote-highlight:true;">db</span><span style="font-size: 11pt; background-color: rgb(255, 250, 165); font-weight: bold;-evernote-highlight:true;">.createCollection</span><span style="font-size: 11pt; background-color: rgb(255, 250, 165);-evernote-highlight:true;">(&quot;collName&quot;</span><span style="font-size: 11pt;">, {size: 5242880, capped: true, max: 5000}); 最大存储空间为 5m，最多 5000 个数据文档的集合； 如果超了，会把老的删掉。</span></div><div><br/></div><div><span style="font-size: 11pt;">        （2）得到指定名称的聚集集合</span></div><div><span style="font-size: 11pt;">                db.getCollection(&quot;account&quot;);</span></div><div><br/></div><div><span style="font-size: 11pt;">        得到当前db的所有聚集集合</span></div><div><span style="font-size: 11pt;">                db.getCollectionNames();</span></div><div><br/></div><div><span style="font-size: 11pt;">        显示当前db所有聚集的状态</span></div><div><span style="font-size: 11pt;">                db.printCollectionStats();</span></div><div><br/></div><div><span style="font-size: 11pt;">4、 nodejs中操作mongodb 进行增删改查的数据库操作。（类似json ； 不用提前插入字段）</span></div><div><br/></div><div><span style="font-size: 11pt; line-height: 1.45;">        （1）添加 （users：数据库的名字；）</span></div><div><span style="font-size: 11pt;">                    <span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">db.users</span></span><span style="font-size: 11pt; font-weight: bold; background-color: rgb(255, 250, 165);-evernote-highlight:true;">.save</span><span style="font-size: 11pt;">({name: ‘zhangsan', age: 25, sex: true});</span></div><div><span style="font-size: 11pt;">                    db.users.save([{name: ‘zhangsan', age: 25, sex: true},{name:”kerin”,age:100}]);  <span style="background-color: rgb(255, 250, 165); font-size: 11pt;-evernote-highlight:true;">//一次性添加多个数据</span></span></div><div><br/></div><div><span style="font-size: 11pt;">        （2）修改  </span></div><div><br/></div><div><span style="font-size: 11pt;">                   <span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;"> db.users</span></span><span style="font-size: 11pt; font-weight: bold; background-color: rgb(255, 250, 165);-evernote-highlight:true;">.update</span><span style="font-size: 11pt;">({age: 25}, {</span><span style="font-size: 11pt; font-weight: bold;">$set</span><span style="font-size: 11pt;">: {name: 'changeName'}}, false, true);</span></div><div><span style="font-size: 11pt;">                (</span> <span style="font-size: 11pt; font-weight: bold;">过滤条件 ， 修改</span> <span style="font-size: 11pt;">，false</span><span style="font-size: 11pt; background-color: rgb(255, 250, 165);-evernote-highlight:true;">：如果没有相应数据就插入数据</span> <span style="font-size: 11pt;">，true</span><span style="font-size: 11pt; background-color: rgb(255, 250, 165);-evernote-highlight:true;">：如果查询出多个全部修改 ；false为只修改第一个  </span> <span style="font-size: 11pt;">  </span><span style="font-size: 11pt;">)</span></div><div><span style="font-size: 11pt;">                   <span style="background-color: rgb(255, 250, 165); font-size: 11pt;-evernote-highlight:true;"> </span><span style="background-color: rgb(255, 250, 165); font-size: 11pt;-evernote-highlight:true;">相当于：update users set name = ‘changeName' where age = 25;</span></span></div><div><br/></div><div><span style="font-size: 11pt;">                    db.users.update({name: 'Lisi'}, {</span><span style="font-size: 11pt; font-weight: bold;">$inc</span><span style="font-size: 11pt;">: {age: 50}}, false, true);</span></div><div><span style="font-size: 15px; line-height: 21px;">                （比 原来的 基础上 加50；可以写负值 意味着减去）</span></div><div><span style="font-size: 11pt;">                   <span style="background-color: rgb(255, 250, 165); font-size: 11pt;-evernote-highlight:true;"> </span><span style="background-color: rgb(255, 250, 165); font-size: 11pt;-evernote-highlight:true;">相当于：update users set age = age + 50 where name = ‘Lisi';</span></span></div><div><br/></div><div><span style="font-size: 11pt;">                    db.users.update({name: 'Lisi'}, {</span><span style="font-size: 11pt; font-weight: bold;">$inc</span><span style="font-size: 11pt;">: {age: 50}, $set: {name: kerwin'}}, false, true);</span></div><div><span style="font-size: 11pt;">                    <span style="background-color: rgb(255, 250, 165); font-size: 11pt;-evernote-highlight:true;">相当于：update users set age = age + 50, name = ‘hoho' where name = ‘kerwin';</span></span></div><div><br/></div><div><span style="font-size: 11pt;">          （3）删除</span></div><div><span style="font-size: 11pt;">                   <span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;"> db.users</span></span><span style="font-size: 11pt; font-weight: bold; background-color: rgb(255, 250, 165);-evernote-highlight:true;">.remove</span><span style="font-size: 11pt;">({age: 132});</span></div><div><br/></div><div><span style="font-size: 11pt;">主键自动生成：</span></div><div><img src="2.4 MongoDB 术语 数据库操作 工具增删改查_files/Image [1].png" type="image/png" style="font-size: 11pt;"/></div><div><br/></div><div><span style="font-size: 11pt;">5、<span style="font-size: 11pt;">聚集集合查询</span></span></div><div><span style="font-size: 11pt;">            查询所有记录</span></div><div><span style="font-size: 11pt;">                    </span><span style="font-size: 11pt; font-weight: bold;">db.userInfo.find</span><span style="font-size: 11pt;">();</span></div><div><span style="font-size: 11pt;">                    <span style="background-color: rgb(255, 250, 165); font-size: 11pt;-evernote-highlight:true;">相当于：select* from userInfo;</span></span></div><div><br/></div><div><span style="font-size: 11pt;">            查询某字段去重后数据</span></div><div><span style="font-size: 11pt;">                    db.userInfo</span><span style="font-size: 11pt; font-weight: bold;">.distinct</span><span style="font-size: 11pt;">(&quot;name&quot;);</span></div><div><span style="font-size: 11pt;">                    <span style="background-color: rgb(255, 250, 165); font-size: 11pt;-evernote-highlight:true;">相当于：select distict name from userInfo;</span></span></div><div><br/></div><div><span style="font-size: 11pt;">            查询</span><span style="font-size: 11pt; line-height: 1.45;">age = 22的记录</span></div><div><span style="font-size: 11pt; line-height: 1.45;">                    db.userInfo.find({&quot;age&quot;: 22});</span></div><div><span style="font-size: 11pt;">                   <span style="background-color: rgb(255, 250, 165); font-size: 11pt;-evernote-highlight:true;"> </span><span style="background-color: rgb(255, 250, 165); font-size: 11pt;-evernote-highlight:true;">相当于： select * from userInfo where age = 22;</span></span></div><div><br/></div><div><span style="font-size: 11pt;">            查询age &gt; 22的记录</span></div><div><span style="font-size: 11pt;">                    db.userInfo.find({age: {$gt: 22}});</span></div><div><span style="font-size: 11pt;">                    <span style="background-color: rgb(255, 250, 165); font-size: 11pt;-evernote-highlight:true;">相当于：select * from userInfo where age &gt;22;</span></span></div><div><br/></div><div><span style="font-size: 11pt;">            查询age &lt; 22的记录</span></div><div><span style="font-size: 11pt;">                    db.userInfo.find({age: {$lt: 22}});</span></div><div><span style="font-size: 11pt;">                    <span style="background-color: rgb(255, 250, 165); font-size: 11pt;-evernote-highlight:true;">相当于：select * from userInfo where age &lt;22;</span></span></div><div><br/></div><div><span style="font-size: 11pt;"><span style="font-size: 11pt;">            查询age &gt;= 25的记录</span></span></div><div><span style="font-size: 11pt;"><span style="font-size: 11pt;">                    db.userInfo.find({age: {$gte: 25}});</span></span></div><div><span style="font-size: 11pt;"><span style="font-size: 11pt;">                   <span style="background-color: rgb(255, 250, 165); font-size: 11pt;-evernote-highlight:true;"> </span><span style="background-color: rgb(255, 250, 165); font-size: 11pt;-evernote-highlight:true;">相当于：select * from userInfo where age &gt;= 25;</span></span></span></div><div><br/></div><div><span style="font-size: 11pt;"><span style="font-size: 11pt;">            查询age &lt;= 25的记录</span></span></div><div><span style="font-size: 11pt;"><span style="font-size: 11pt;">                    db.userInfo.find({age: {$lte: 25}});</span></span></div><div><br/></div><div><span style="font-size: 11pt;"><span style="font-size: 11pt;">            查询age &gt;= 23 并且 age &lt;= 26</span></span></div><div><span style="font-size: 11pt;"><span style="font-size: 11pt;">                    db.userInfo.find({age: {$gte: 23, $lte: 26}});</span></span></div><div><br/></div><div><span style="font-size: 11pt;"><span style="font-size: 11pt;">            查询name中包含 mongo的数据 （支持正则 ^ $...）</span></span></div><div><span style="font-size: 11pt;"><span style="font-size: 11pt;">                    db.userInfo.find({name: /mongo/});</span></span></div><div><span style="font-size: 11pt;"><span style="font-size: 11pt;">                    <span style="background-color: rgb(255, 250, 165); font-size: 11pt;-evernote-highlight:true;">//相当于%%select * from userInfo where name like ‘%mongo%’;</span></span></span></div><div><br/></div><div><span style="font-size: 11pt;"><span style="font-size: 11pt;">            查询name中以mongo开头的</span></span></div><div><span style="font-size: 11pt;"><span style="font-size: 11pt;">                    db.userInfo.find({name: /^mongo/});select * from userInfo where name like ‘mongo%’;</span></span></div><div><br/></div><div><br/></div><div><span style="font-size: 11pt;">            查询指定列name、age数据(想显示哪列，就将字段设置为1，不想显示就设置成0)</span></div><div><span style="font-size: 11pt;">                    </span><span style="font-size: 11pt; font-weight: bold;">db.userInfo.find</span><span style="font-size: 11pt;">({}, {name: 1, age: 1});相当于：select name, age from userInfo;</span></div><div><br/></div><div><span style="font-size: 11pt;">            查询指定列name、age数据, age &gt; 25</span></div><div><span style="font-size: 11pt;">                    </span><span style="font-size: 11pt; font-weight: bold;">db.userInfo.find</span><span style="font-size: 11pt;">({age: {$gt: 25}}, {name: 1, age: 1});</span></div><div><span style="font-size: 11pt;">                   <span style="background-color: rgb(255, 250, 165); font-size: 11pt;-evernote-highlight:true;"> </span><span style="background-color: rgb(255, 250, 165); font-size: 11pt;-evernote-highlight:true;">相当于：select name, age from userInfo where age &gt;25;</span></span></div><div><br/></div><div><span style="font-size: 11pt;">            按照年龄</span><span style="font-size: 11pt; font-weight: bold;">排序</span><span style="font-size: 11pt;">（写成数组就是多列查询）</span></div><div><span style="font-size: 11pt;">                    升序：db.userInfo.find()</span><span style="font-size: 11pt; font-weight: bold;">.sort</span><span style="font-size: 11pt;">({age:</span> <span style="font-size: 11pt; font-weight: bold;">1</span><span style="font-size: 11pt;">});   </span></div><div><span style="font-size: 11pt;">                    降序：db.userInfo.find()</span><span style="font-size: 11pt; font-weight: bold;">.sort</span><span style="font-size: 11pt;">({age:</span> <span style="font-size: 11pt; font-weight: bold;">-1</span><span style="font-size: 11pt;">});</span></div><div><br/></div><div><span style="font-size: 11pt;">            查询name = zhangsan, age = 22的数据</span></div><div><span style="font-size: 11pt;">                    </span><span style="font-size: 11pt; font-weight: bold;">db.userInfo.find</span><span style="font-size: 11pt;">({name: 'zhangsan', age: 22});</span></div><div><span style="font-size: 11pt;">                   <span style="background-color: rgb(255, 250, 165); font-size: 11pt;-evernote-highlight:true;"> </span><span style="background-color: rgb(255, 250, 165); font-size: 11pt;-evernote-highlight:true;">相当于：select * from userInfo where name = ‘zhangsan' and age = ’22';</span></span></div><div><br/></div><div><span style="font-size: 11pt;">            查询前5条数据</span></div><div><span style="font-size: 11pt;">                    db.userInfo.find()</span><span style="font-size: 11pt; font-weight: bold;">.limit</span><span style="font-size: 11pt;">(5);</span></div><div><span style="font-size: 11pt;">                    <span style="background-color: rgb(255, 250, 165); font-size: 11pt;-evernote-highlight:true;">相当于：select top 5 * from userInfo;</span></span></div><div><br/></div><div><span style="font-size: 11pt;">            查询10条以后的数据</span></div><div><span style="font-size: 11pt;">                    db.userInfo.find()</span><span style="font-size: 11pt; font-weight: bold;">.skip</span><span style="font-size: 11pt;">(10);</span></div><div><span style="font-size: 11pt;">                    <span style="background-color: rgb(255, 250, 165); font-size: 11pt;-evernote-highlight:true;">相当于：select * from userInfo where id not in (   select top 10 * from userInfo);</span></span></div><div><br/></div><div><span style="font-size: 11pt;">            查询在</span><span style="font-size: 11pt; font-weight: bold;">6-10</span><span style="font-size: 11pt;">之间的数据 </span></div><div><span style="font-size: 11pt;">                    db.userInfo.find()</span><span style="font-size: 11pt; font-weight: bold;">.skip</span><span style="font-size: 11pt;">(5)</span><span style="font-size: 11pt; font-weight: bold;">.limit</span><span style="font-size: 11pt;">(5);</span></div><div><span style="font-size: 11pt;">                    // <span style="font-size: 11pt;">db.userInfo.find()<span style="font-size: 11pt; font-weight: bold;">.sort</span><span style="font-size: 11pt;">()</span></span><span style="font-size: 11pt; font-weight: bold;">.skip</span><span style="font-size: 11pt;">(20)</span><span style="font-size: 11pt; font-weight: bold;">.limit</span><span style="font-size: 11pt;">(20);<span style="font-size: 11pt;">（分页接口）</span></span></span></div><div><br/></div><div><span style="font-size: 11pt;">            or与 查询 ( 或者 ， 满足一个即可 )</span></div><div><span style="font-size: 11pt;">                    db.userInfo.find({$or: [{age: 22}, {age: 25}]});</span></div><div><span style="font-size: 11pt;">                    <span style="background-color: rgb(255, 250, 165); font-size: 11pt;-evernote-highlight:true;">相当于：select * from userInfo where age = 22 or age = 25;</span></span></div><div><br/></div><div><span style="font-size: 11pt;">            查询第一条数据</span></div><div><span style="font-size: 11pt;">                    db.userInfo</span><span style="font-size: 11pt; font-weight: bold;">.findOne</span><span style="font-size: 11pt;">();</span></div><div><span style="font-size: 11pt;">                    <span style="background-color: rgb(255, 250, 165); font-size: 11pt;-evernote-highlight:true;">相当于：selecttop 1 * from userInfo;db.userInfo.find().limit(1);</span></span></div><div>    </div><div><span style="font-size: 11pt;">            查询某个结果集的记录条数</span></div><div><span style="font-size: 11pt;">                    db.userInfo.find({age: {$gte: 25}})</span><span style="font-size: 11pt; font-weight: bold;">.count</span><span style="font-size: 11pt;">();</span></div><div><span style="font-size: 11pt;">                    <span style="background-color: rgb(255, 250, 165); font-size: 11pt;-evernote-highlight:true;">相当于：select count(*) from userInfo where age &gt;= 20;</span></span></div><div><br/></div><div><br/></div><div><br/></div><div><span style="font-size: 11pt;">6、可视化工具进行增删改查</span></div><div><br/></div><div><span style="font-size: 11pt;">        Robomongo:</span></div><div><span style="font-size: 15px; line-height: 21px;">        （1）、数据库开着</span></div><div><span style="font-size: 15px; line-height: 21px;">        （2）、create   数据库默认端口号21017</span></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div></span>
</div></body></html> 