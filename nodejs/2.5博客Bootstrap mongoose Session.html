<html>
<head>
  <title>2.5博客Bootstrap mongoose Session</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/303788 (zh-CN, DDL); Windows/6.1.7601 Service Pack 1 (Win32);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="594"/>
<h1>2.5博客Bootstrap mongoose Session</h1>

<div>
<span><div><span style="font-weight: bold;">概要：</span></div><div><span style="font-weight: bold;">Bootstrap-ui框架  </span><span style="font-size: 15px; font-family: 微软雅黑; font-weight: bold; line-height: 21px;">mongoose模块   Session</span></div><div><span style="font-size: 10pt;"><span style="font-size: 10pt; font-weight: bold;"> </span></span><span style="font-size: 10pt; font-weight: bold; line-height: 1.45;">登录 注册 添加数据库</span></div><div><br/></div><div>1、准备</div><div>        （1）、存放数据库   ==&gt; cd test </div><div>        （2）、express -e test </div><div>        （3）、<span style="font-size: 10pt;">npm install</span></div><div><span style="font-size: 10pt;">        （4）、 npm start</span></div><div><img src="2.5博客Bootstrap mongoose Session_files/Image.png" type="image/png"/></div><div><br/></div><div><span style="font-size: 10pt;"><span style="font-size: 10pt; font-weight: bold;">bootstrap：ui框架  多用于后台管理系统</span></span></div><div><span style="font-size: 10pt;"><span style="font-size: 10pt; font-weight: bold;">        响应式原理：媒体查询</span></span></div><div><br/></div><div>2、存数据库  </div><div>        <span style="font-weight: bold;">引入 mongoose模块</span> ， 帮助我们去连接数据库</div><div>        第三方模块 需要安装 ==&gt; npm install --save-dev mongoose</div><div><br/></div><div style="box-sizing: border-box; padding: 8px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; border: 1px solid rgba(0, 0, 0, 0.14902);"><div style="background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248);"><span style="font-size: 15px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: 微软雅黑; line-height: 21px;">//////////////////////////////////////////////////</span><span style="font-size: 15px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: 微软雅黑; font-weight: bold; line-height: 21px;">model/user.js </span><span style="background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 14pt; color: rgb(51, 51, 51); font-family: 微软雅黑; font-weight: bold; line-height: 21px;">概要计划</span></span></span></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><span style="font-size: 15px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: 微软雅黑; line-height: 21px;">var mongoose = require(&quot;mongo0se&quot;);</span></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><span style="font-size: 15px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: 微软雅黑; line-height: 21px;">var Schema = mongoose.Schema; <span style="background-color: rgb(255, 250, 165); font-size: 15px;-evernote-highlight:true;"><span style="background-color: rgb(255, 250, 165); font-size: 15px; color: rgb(51, 51, 51); font-family: 微软雅黑; line-height: 21px; font-weight: bold;-evernote-highlight:true;">//概要计划</span></span></span></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><br/></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><span style="font-size: 15px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: 微软雅黑; line-height: 21px;">var obj = {</span></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><span style="font-size: 15px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: 微软雅黑; line-height: 21px;">    username:String,</span></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><span style="font-size: 15px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: 微软雅黑; line-height: 21px;">    password:String,</span></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><span style="font-size: 15px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: 微软雅黑; line-height: 21px;">    email:String</span></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><span style="font-size: 15px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: 微软雅黑; line-height: 21px;">}</span></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><br/></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><span style="font-size: 15px; background-color: rgb(255, 250, 165); color: rgb(51, 51, 51); font-family: 微软雅黑; line-height: 21px;-evernote-highlight:true;">//通过一个对象model  映射一个表 通过model操作数据库</span></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><span style="font-size: 15px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: 微软雅黑; line-height: 21px;">var model = mongoose.model(&quot;user&quot;,new Schema(obj)); <span style="background-color: rgb(255, 250, 165); font-size: 15px; color: rgb(51, 51, 51); font-family: 微软雅黑; line-height: 21px;-evernote-highlight:true;">//自动加s ==&gt;&quot;users&quot; </span></span></div><div style="font-size: 12px;"><span style="background-color: rgb(255, 250, 165); font-size: 12px;-evernote-highlight:true;">//通过model 来进行数据库操作（增删改查） 来操作users这个表（集合）    在js代码中操作</span></div><div style="font-size: 12px;"><span style="background-color: rgb(255, 250, 165); font-size: 12px;-evernote-highlight:true;">// users 表中有 3个字段</span></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><br/></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><br/></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><span style="font-size: 15px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: 微软雅黑; line-height: 21px;">module.exports = model;</span></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><br/></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><span style="font-size: 15px; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: 微软雅黑; line-height: 21px;">//////////////////////////////////////////////////////////<span style="background-color: rgb(251, 250, 248); font-size: 15px; color: rgb(51, 51, 51); font-family: 微软雅黑; line-height: 21px; font-weight: bold;">app.js</span></span></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><br/></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 11pt;"><span style="background-color: rgb(251, 250, 248); font-size: 11pt; color: rgb(51, 51, 51); font-family: 微软雅黑; font-weight: bold;">var mongoose = require(&quot;mongoose&quot;)</span></span></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><span style="background-color: rgb(255, 250, 165); font-size: 11pt;-evernote-highlight:true;"><span style="background-color: rgb(255, 250, 165); font-size: 11pt; color: rgb(51, 51, 51); font-family: 微软雅黑; font-weight: bold;-evernote-highlight:true;">//引入mongoose模块   要创建一个概要计划的 model</span></span></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><span style="font-size: 15px; background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 15px; color: rgb(51, 51, 51); font-family: 微软雅黑; font-weight: bold; line-height: 21px;">mongoose.connect(&quot;mongodb://localhost:27017/test&quot;)</span></span></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><span style="font-size: 15px; background-color: rgb(255, 250, 165); color: rgb(51, 51, 51); font-family: 微软雅黑; line-height: 21px;-evernote-highlight:true;"><span style="background-color: rgb(255, 250, 165); font-size: 15px; color: rgb(51, 51, 51); font-family: 微软雅黑; line-height: 21px; font-weight: bold;-evernote-highlight:true;">//连接地址   27017为默认端口号    服务器需重启</span>  </span></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><span style="font-size: 15px; background-color: rgb(255, 250, 165);-evernote-highlight:true;"><span style="background-color: rgb(255, 250, 165); font-size: 11pt; color: rgb(51, 51, 51); font-family: 微软雅黑; line-height: 21px;-evernote-highlight:true;">//报错 修改</span></span></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><span style="font-size: 15px; background-color: rgb(255, 250, 165);-evernote-highlight:true;"><span style="background-color: rgb(255, 250, 165); font-size: 11pt; color: rgb(51, 51, 51); font-family: 微软雅黑; line-height: 21px;-evernote-highlight:true;">//var promise = mongoose.connect('mongodb://localhost:27017/testdata', {</span></span></div><div><span style="background-color: rgb(255, 250, 165); font-size: 11pt; color: rgb(51, 51, 51);-evernote-highlight:true;">  useMongoClient: true</span></div><div><span style="background-color: rgb(255, 250, 165); font-size: 11pt; color: rgb(51, 51, 51);-evernote-highlight:true;">  /* other options */</span></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><div><span style="background-color: rgb(255, 250, 165); font-size: 11pt; color: rgb(51, 51, 51);-evernote-highlight:true;">});</span></div></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><br/></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><br/></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><br/></div><div><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;"><span style="background-color: rgb(255, 250, 165); font-size: 12pt; font-weight: bold;-evernote-highlight:true;">//session!!  属于存放在后端的  ，而cookie是存在本地、浏览器端。  session和cookie配合，用于用户身份凭证，来实现登录。</span></span></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><span style="font-size: 15px; background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 15px; color: rgb(51, 51, 51); font-family: 微软雅黑; font-weight: bold; line-height: 21px;">var session = require(&quot;express-session&quot;);</span></span></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><div><br/></div></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><span style="font-size: 11pt; background-color: rgb(255, 250, 165);-evernote-highlight:true;"><span style="background-color: rgb(255, 250, 165); font-size: 11pt; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-weight: bold;-evernote-highlight:true;">//初始化  注册路由</span></span></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><span style="font-size: 11pt; background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 11pt; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-weight: bold;">app.use(session({</span></span></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 11pt; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-weight: bold;">    name: &quot;kerwinNodeSessID&quot;,</span> <span style="background-color: rgb(255, 250, 165); font-size: 11pt; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-weight: bold;-evernote-highlight:true;">//name值 </span><span style="background-color: rgb(251, 250, 248); font-size: 11pt; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-weight: bold;">  </span></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><span style="font-size: 11pt; background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 11pt; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-weight: bold;">    secret:&quot;dw3243dw&quot;,        </span><span style="background-color: rgb(255, 250, 165); font-size: 11pt; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-weight: bold;-evernote-highlight:true;">//加密</span></span></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><span style="font-size: 11pt; background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 11pt; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-weight: bold;">    cookie: {maxAge: 1000*3600 },</span> <span style="background-color: rgb(255, 250, 165); font-size: 11pt; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-weight: bold;-evernote-highlight:true;">//cookie多长时间1小时    </span></span></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><span style="font-size: 11pt; background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 11pt; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-weight: bold;">    resave: true,            </span> <span style="background-color: rgb(255, 250, 165); font-size: 11pt; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-weight: bold;-evernote-highlight:true;">//</span></span></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><span style="font-size: 11pt; background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 11pt; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-weight: bold;">    saveUninitialized: true   </span><span style="background-color: rgb(255, 250, 165); font-size: 11pt; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-weight: bold;-evernote-highlight:true;">//自动生成ID （有就不生成）</span></span></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><span style="font-size: 11pt; background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 11pt; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-weight: bold;">}));  </span></span></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><span style="font-size: 15px; background-color: rgb(255, 250, 165);-evernote-highlight:true;"><span style="background-color: rgb(255, 250, 165); font-size: 15px; color: rgb(51, 51, 51); font-family: 微软雅黑; font-weight: bold; line-height: 21px;-evernote-highlight:true;">//注册 express-session 模块 （中间件）</span></span></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><br/></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 11pt; color: rgb(51, 51, 51); font-family: 微软雅黑;">//////////////////////////////////////////////<span style="background-color: rgb(251, 250, 248); font-size: 11pt; color: rgb(51, 51, 51); font-family: 微软雅黑; font-weight: bold;">routes/register.js</span></span></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 11pt; color: rgb(51, 51, 51); font-family: 微软雅黑;">var express = require(&quot;express&quot;);</span></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 11pt; color: rgb(51, 51, 51); font-family: 微软雅黑;">var router = express.Router;</span></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><br/></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 11pt; color: rgb(51, 51, 51); font-family: 微软雅黑;">var User = require(&quot;../model/user&quot;);</span></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><br/></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 11pt; color: rgb(51, 51, 51); font-family: 微软雅黑;">router.post(&quot;/validate&quot;,function(){</span></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><br/></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 11pt; color: rgb(51, 51, 51); font-family: 微软雅黑;">     console.log(req.body);</span></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><br/></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 11pt; color: rgb(51, 51, 51); font-family: 微软雅黑;">     User.create({</span></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 11pt; color: rgb(51, 51, 51); font-family: 微软雅黑;">        username:req.body.username,</span></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 11pt; color: rgb(51, 51, 51); font-family: 微软雅黑;">        password:req.body.password,</span></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><span style="font-size: 11pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: 微软雅黑;">    </span><span style="font-size: 11pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: 微软雅黑;">    email:req.body.email</span><span style="background-color: rgb(251, 250, 248); font-size: 11pt; color: rgb(51, 51, 51); font-family: 微软雅黑;">   </span></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 11pt; color: rgb(51, 51, 51); font-family: 微软雅黑;">    },function(error,info){</span></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 11pt; color: rgb(51, 51, 51); font-family: 微软雅黑;">        if(!error){</span></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 11pt; color: rgb(51, 51, 51); font-family: 微软雅黑;">            res.redirect(&quot;/login&quot;);</span></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 11pt; color: rgb(51, 51, 51); font-family: 微软雅黑;">        }else{</span></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 11pt; color: rgb(51, 51, 51); font-family: 微软雅黑;">            console.log(error);</span></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 11pt; color: rgb(51, 51, 51); font-family: 微软雅黑;">        }</span></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 11pt; color: rgb(51, 51, 51); font-family: 微软雅黑;">    })</span></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><br/></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 11pt; color: rgb(51, 51, 51); font-family: 微软雅黑;">})</span></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><br/></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><span style="font-size: 11pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: 微软雅黑;">/////////////////////////////////////////////////<span style="background-color: rgb(251, 250, 248); font-size: 11pt; color: rgb(51, 51, 51); font-family: 微软雅黑; font-weight: bold;">routes/login.js</span></span></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><br/></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><span style="font-size: 11pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: 微软雅黑;">/* login.ejs</span></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><img src="2.5博客Bootstrap mongoose Session_files/Image [1].png" type="image/png" style="font-size: 11pt; color: rgb(51, 51, 51);"/></span></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><img src="2.5博客Bootstrap mongoose Session_files/Image [2].png" type="image/png" style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></span></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">*/</span></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><br/></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><span style="font-size: 11pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: 微软雅黑;">var User = require(&quot;../model/user&quot;);</span></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><span style="font-size: 11pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: 微软雅黑;">router.post(&quot;/validate&quot;,function(req,res,next){</span></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><br/></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">    User.find({</span></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">        username:req.body.username,</span></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">        password:req.body.password</span></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">    },functiong(error,info){</span></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">        if(!error){</span></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">            if(info.length == 0){</span></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">                res.render(&quot;login&quot;,isTrue:ture)</span></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">            }else{</span></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">               </span> <span style="background-color: rgb(255, 250, 165); font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;-evernote-highlight:true;">//设置session有效</span></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">                res.session.kerwin = info[0];</span></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><br/></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">                res.redirect(&quot;/&quot;);</span></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">            }</span></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">        }else{</span></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><br/></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">        }</span></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><br/></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><br/></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12pt; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">    })</span></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><br/></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><span style="font-size: 11pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: 微软雅黑;">   </span></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><br/></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><span style="font-size: 11pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: 微软雅黑;">})</span></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><br/></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><span style="font-size: 11pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: 微软雅黑;">////////////////////////////////////////////////<span style="background-color: rgb(251, 250, 248); font-size: 11pt; color: rgb(51, 51, 51); font-family: 微软雅黑; font-weight: bold;">routes/index.js</span></span></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;"><img src="2.5博客Bootstrap mongoose Session_files/Image [3].png" type="image/png"/></span></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><br/></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12px;"><img src="2.5博客Bootstrap mongoose Session_files/Image [4].png" type="image/png" style="font-size: 9pt;"/></span></div><div style="font-size: 12px; background-color: rgb(251, 250, 248);"><br/></div></div><div><span style="font-size: 10pt;">    </span></div><div><span style="font-size: 15px;"><span style="font-size: 15px; font-family: 微软雅黑; font-weight: bold; line-height: 21px;">Session</span></span></div><div><br/></div><div><span style="font-size: 15px;"><span style="font-size: 15px; font-family: 微软雅黑; font-weight: bold; line-height: 21px;">安装 npm install --save-dev express-session</span></span></div><div><img src="2.5博客Bootstrap mongoose Session_files/Image [5].png" type="image/png"/></div><div><img src="2.5博客Bootstrap mongoose Session_files/Image [6].png" type="image/png"/></div><div><br/></div><div><img src="2.5博客Bootstrap mongoose Session_files/Image [7].png" type="image/png"/></div><div><br/></div><div><span style="font-weight: bold;">cookie</span>：</div><div>    存储在浏览器、容易过期、操作方式麻烦（document.cookie截取字符串）</div><div>    不可以跨域访问</div><div>    存储量小(4kb)</div><div>    只能存字符串</div><div>    客户端存储</div><div><img src="2.5博客Bootstrap mongoose Session_files/Image [8].png" type="image/png"/></div><div><br/></div><div><span style="font-weight: bold;">session</span>：</div><div>    </div><div>    永久存储</div><div>    不能存对象，要JSON转换</div><div>    服务端存储</div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><b>session 和 cookie 配合 实现登录状态</b></div><div><hr/><div><br/></div></div><div>    localStorage.setItem( )</div><div>    localStorage.getItem( )</div><div>    localStorage.removeItem( )</div><div>    localStorage.clear( )</div><div><img src="2.5博客Bootstrap mongoose Session_files/Image [9].png" type="image/png"/></div><div>    </div><div><img src="2.5博客Bootstrap mongoose Session_files/Image [10].png" type="image/png"/></div><div><br/></div><div><br/></div><div><img src="2.5博客Bootstrap mongoose Session_files/Image [11].png" type="image/png"/></div><div>local storage ：</div><div>本地存储</div><div>有的浏览器存储流量不限制</div><div>关闭浏览器 还有</div><div><br/></div><div>session storage：</div><div>关闭浏览器没有</div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div></span>
</div></body></html> 