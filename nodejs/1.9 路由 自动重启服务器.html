<html>
<head>
  <title>1.9 路由 自动重启服务器</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/303788 (zh-CN, DDL); Windows/6.1.7601 Service Pack 1 (Win32);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="940"/>
<h1>1.9 路由 自动重启服务器</h1>

<div>
<span><div><b>根据不同的路径 ，返回不同的页面信息到前台页面。</b>   路由机制</div><div><br/></div><div>文件夹：</div><div>route ===&gt; index.js</div><div>                   html ===&gt; login.html</div><div>                                     register.html</div><div>                                     home.html</div><div>                                     error.html</div><div>                    module ===&gt; router.js</div><div>                                           render.js</div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-size: 12px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; border: 1px solid rgba(0, 0, 0, 0.14902);"><div style="background-color: rgb(251, 250, 248);"><br/></div><div style="background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">/////////////////////////////////////////////////index.js</span></div><div style="background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">var http = require(&quot;http&quot;);</span></div><div style="background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">var url = require (&quot;url&quot;);</span></div><div style="background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">var router = require(&quot;./module/router.js&quot;);</span></div><div style="background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">http.createServer(function(req,res){</span></div><div style="background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">     if(req.url == &quot;/favicon.ico&quot;){</span></div><div style="background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">          return;</span></div><div style="background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">     }</span></div><div style="background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">     var path = url.parse(req.url).pathname;</span></div><div style="background-color: rgb(251, 250, 248);"><br/></div><div style="background-color: rgb(251, 250, 248);"><br/></div><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">     </span><span style="font-size: 12px; background-color: rgb(255, 250, 165); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;-evernote-highlight:true;">//容错处理</span></div><div style="background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">     //if(router[path]){</span></div><div style="background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">     //      router[path](res);</span></div><div style="background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">    // }else{</span></div><div style="background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">    //     router[&quot;/404&quot;](res);</span></div><div style="background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">    //}</span></div><div style="background-color: rgb(251, 250, 248);"><br/></div><div style="background-color: rgb(251, 250, 248);"><br/></div><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">     </span><span style="font-size: 12px; background-color: rgb(255, 250, 165); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;-evernote-highlight:true;">//捕获异常   js异常处理</span></div><div style="background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">     try{</span></div><div style="background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">          router[path](res);</span></div><div style="background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">     }catch(e){</span></div><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">            //console.log(e);           </span><span style="font-size: 12px; background-color: rgb(255, 250, 165); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;-evernote-highlight:true;">//打印错误</span></div><div style="background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">           router[&quot;/404&quot;](res);</span></div><div style="background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">     }</span></div><div style="background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">     </span></div><div style="background-color: rgb(251, 250, 248);"><br/></div><div style="background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">}).listen(3000);</span></div><div style="background-color: rgb(251, 250, 248);"><br/></div><div style="background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">/////////////////////////////////////////////////////router.js</span></div><div><span style="font-size: 12px; background-color: rgb(255, 250, 165); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;-evernote-highlight:true;">//核心框架</span></div><div style="background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">var fs = require(&quot;fs&quot;);</span></div><div style="background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">var render = require(&quot;./render&quot;);</span></div><div style="background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">var router = {</span></div><div style="background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">    </span></div><div style="background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">      &quot;/home&quot;:function(res){</span></div><div style="background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">           render(&quot;./html/home.html&quot;,res);</span></div><div><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">          </span><span style="font-size: 12px; background-color: rgb(255, 250, 165); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;-evernote-highlight:true;">//html路径的问题：以启动项目的文件夹为根目录</span></div><div style="background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">     },</span></div><div style="background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">     </span></div><div style="background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">     &quot;/register&quot;:function(res){</span></div><div style="background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">           render(&quot;./html/register.html&quot;,res);</span></div><div style="background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">     },</span></div><div style="background-color: rgb(251, 250, 248);"><br/></div><div style="background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">     &quot;/404&quot;:function(res){</span></div><div style="background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">          render(&quot;./html/error404.html&quot;,res);</span></div><div style="background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">     }</span></div><div style="background-color: rgb(251, 250, 248);"><br/></div><div style="background-color: rgb(251, 250, 248);"><br/></div><div style="background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">}</span></div><div style="background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">module.exports = router;</span></div><div style="background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">///////////////////////////////////////////////////////render.js</span></div><div style="background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">var fs = require(&quot;fs&quot;);</span></div><div style="background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">function render(path,res){</span></div><div style="background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">         </span></div><div style="background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">fs.readFile(path,&quot;utf8&quot;,function(error,info){</span></div><div style="background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">               if(!error){</span></div><div style="background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">          </span></div><div style="background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">           res.writeHead(200,{&quot;Content-type&quot;:......            }) ;</span></div><div style="background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">                    res.write(info);</span></div><div style="background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">                    res.end();  </span></div><div style="background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">               }else{</span></div><div style="background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">                    console.log(error);</span></div><div style="background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">               }</span></div><div style="background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">         })</span></div><div style="background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">}</span></div><div style="background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">module.exports = render;</span></div><div style="background-color: rgb(251, 250, 248);"><br/></div><div style="background-color: rgb(251, 250, 248);"><span style="background-color: rgb(251, 250, 248); font-size: 12px; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">//////////////////////////////////////////////////////////////////</span></div></div><div><br/></div><div><br/></div><div>自动重启服务器： 自动刷新</div><div>     node-dev 模块</div><div>     安装：</div><div>          npm install -g node-dev</div><div>     启动：</div><div>          node-dev index.js</div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div></span>
</div></body></html> 