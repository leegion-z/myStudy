<html>
<head>
  <title>ES6&gt;promise-解决异步 &amp; axios.get()复件</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/303788 (zh-CN, DDL); Windows/6.1.7601 Service Pack 1 (Win32);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="718"/>
<h1>ES6&gt;promise-解决异步 &amp; axios.get()复件</h1>

<div>
<span><div>解决异步调用：</div><div><img src="ES6promise-解决异步 & axios.get()复件_files/Image.png" type="image/png"/></div><div><br/></div><div><br/></div><div><img src="ES6promise-解决异步 & axios.get()复件_files/Image [1].png" type="image/png"/></div><div><br/></div><div>1、异步流程</div><div>     链式调用 解决：</div><div>         （1）回调地狱-嵌套金字塔，嵌套非常深的时候，结构不清晰</div><div>         （2）当所有的异步都结束之后，再做处理</div><div><img src="ES6promise-解决异步 & axios.get()复件_files/2017-12-12_145054.png" type="image/png" style="height: auto;"/></div><div><br/></div><div>2、将异步流程转换为同步实现</div><div>     三种状态：</div><div>          （1）pending 状态 (默认)</div><div>          （2）resolve  状态</div><div>          （3）reject     状态 :拒绝承诺 停止函数</div><div>      状态转换：</div><div>          pending -&gt; resolve 或  pending -&gt; reject（出错时的处理）</div><div><br/></div><div>解耦：函数与函数之间没有关系 ，没有干扰。</div><div style="box-sizing: border-box; padding: 8px; font-size: 12px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; border: 1px solid rgba(0, 0, 0, 0.14902);"><div style="background-color: rgb(251, 250, 248);"><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">//////////////////////////////////////////////////////////////////</span></div><div style="background-color: rgb(251, 250, 248);"><br style="font-size: 9pt;"/></div><div style="background-color: rgb(251, 250, 248);"><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">function test1(res){</span></div><div style="background-color: rgb(251, 250, 248);"><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">     return new Promise(function(resolve,reject){</span></div><div><span style="background-color: rgb(251, 250, 248); font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">          setTimeout(function(){   </span><span style="font-size: 9pt; background-color: rgb(255, 250, 165); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;-evernote-highlight:true;">//异步处理</span></div><div style="background-color: rgb(251, 250, 248);"><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">               console.log(&quot;111&quot;);</span></div><div><span style="background-color: rgb(251, 250, 248); font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">               resolve(&quot;第一个接口&quot;);  </span><span style="font-size: 9pt; background-color: rgb(255, 250, 165); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;-evernote-highlight:true;">//调用完后，pending转为resolve状态</span></div><div style="background-color: rgb(251, 250, 248);"><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">               //reject('出错了')；</span></div><div style="background-color: rgb(251, 250, 248);"><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">          },1000)</span></div><div style="background-color: rgb(251, 250, 248);"><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">     })</span></div><div style="background-color: rgb(251, 250, 248);"><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">}</span></div><div style="background-color: rgb(251, 250, 248);"><br style="font-size: 9pt;"/></div><div style="background-color: rgb(251, 250, 248);"><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">function test2(res){</span></div><div style="background-color: rgb(251, 250, 248);"><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">     return new Promise(function(resolve,reject){</span></div><div style="background-color: rgb(251, 250, 248);"><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">          setTimeout(function(){</span></div><div style="background-color: rgb(251, 250, 248);"><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">               console.log(&quot;222&quot;);</span></div><div style="background-color: rgb(251, 250, 248);"><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">               resolve(&quot;第二个接口&quot;);</span></div><div style="background-color: rgb(251, 250, 248);"><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">               //reject('出错了')；</span></div><div style="background-color: rgb(251, 250, 248);"><br style="font-size: 9pt;"/></div><div style="background-color: rgb(251, 250, 248);"><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">          },1000)</span></div><div style="background-color: rgb(251, 250, 248);"><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">     })</span></div><div style="background-color: rgb(251, 250, 248);"><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">}</span></div><div style="background-color: rgb(251, 250, 248);"><br style="font-size: 9pt;"/></div><div style="background-color: rgb(251, 250, 248);"><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">function test3(res){</span></div><div style="background-color: rgb(251, 250, 248);"><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">     return new Promise(function(resolve,reject){</span></div><div style="background-color: rgb(251, 250, 248);"><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">          setTimeout(function(){</span></div><div style="background-color: rgb(251, 250, 248);"><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">               console.log(&quot;333&quot;);</span></div><div style="background-color: rgb(251, 250, 248);"><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">               resolve(&quot;第三个接口&quot;);</span></div><div style="background-color: rgb(251, 250, 248);"><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">                //reject('出错了')；</span></div><div style="background-color: rgb(251, 250, 248);"><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">          },1000)</span></div><div style="background-color: rgb(251, 250, 248);"><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">     })</span></div><div style="background-color: rgb(251, 250, 248);"><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">}</span></div><div style="background-color: rgb(251, 250, 248);"><br style="font-size: 9pt;"/></div><div style="background-color: rgb(251, 250, 248);"><br style="font-size: 9pt;"/></div><div style="background-color: rgb(251, 250, 248);"><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">/*</span></div><div style="background-color: rgb(251, 250, 248);"><br style="font-size: 9pt;"/></div><div style="background-color: rgb(251, 250, 248);"><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">test1().then(function(res){</span></div><div style="background-color: rgb(251, 250, 248);"><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">     </span></div><div style="background-color: rgb(251, 250, 248);"><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">     return test2(res);</span></div><div style="background-color: rgb(251, 250, 248);"><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">}).then(function(res){</span></div><div style="background-color: rgb(251, 250, 248);"><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">     return test3(res);</span></div><div style="background-color: rgb(251, 250, 248);"><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">}).then(function(res){</span></div><div style="background-color: rgb(251, 250, 248);"><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">     console.log(&quot;done&quot;,res);</span></div><div style="background-color: rgb(251, 250, 248);"><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">}).catch(function(error){</span></div><div style="background-color: rgb(251, 250, 248);"><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">    console.log(error);</span></div><div style="background-color: rgb(251, 250, 248);"><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">})</span></div><div style="background-color: rgb(251, 250, 248);"><br style="font-size: 9pt;"/></div><div style="background-color: rgb(251, 250, 248);"><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">*/</span></div><div style="background-color: rgb(251, 250, 248);"><br style="font-size: 9pt;"/></div><div><span style="font-size: 9pt; background-color: rgb(255, 250, 165); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;-evernote-highlight:true;">//用 Promise.all()简写</span></div><div style="background-color: rgb(251, 250, 248);"><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">Promise.all([test1(),test2(),test3()]).then(function(res){</span></div><div style="background-color: rgb(251, 250, 248);"><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">    concole.log(&quot;所有的异步请求都结束&quot;,res)；</span></div><div style="background-color: rgb(251, 250, 248);"><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">        //hide()</span></div><div style="background-color: rgb(251, 250, 248);"><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">        //</span></div><div><span style="background-color: rgb(251, 250, 248); font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">        </span><span style="font-size: 9pt; background-color: rgb(255, 250, 165); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;-evernote-highlight:true;">//动态页面布局</span></div><div style="background-color: rgb(251, 250, 248);"><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">})</span></div><div style="background-color: rgb(251, 250, 248);"><br style="font-size: 9pt;"/></div><div style="background-color: rgb(251, 250, 248);"><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">/*</span></div><div style="background-color: rgb(251, 250, 248);"><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">axios.get(&quot;/list&quot;).then(function(){</span></div><div><span style="background-color: rgb(251, 250, 248); font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">    </span><span style="font-size: 9pt; background-color: rgb(255, 250, 165); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;-evernote-highlight:true;">//axios.get(&quot;/list&quot;) 返回的就是一个promise对象</span></div><div style="background-color: rgb(251, 250, 248);"><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">})</span></div><div style="background-color: rgb(251, 250, 248);"><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">*/</span></div><div style="background-color: rgb(251, 250, 248);"><br style="font-size: 9pt;"/></div><div style="background-color: rgb(251, 250, 248);"><span style="font-size: 9pt; background-color: rgb(251, 250, 248); color: rgb(51, 51, 51); font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;">/////////////////////////////////////////////////////////////////////</span></div></div><div style="font-size: 14px;"><br/></div><div style="font-size: 14px;"><span style="font-size: 14px;">3、怎么终止</span></div><div style="font-size: 14px;"><span style="font-size: 14px;">直接调用rejected 方法</span></div><div style="font-size: 14px;"><br/></div><div style="font-size: 14px;"><br/></div><div style="font-size: 14px;"><br/></div><div style="font-size: 14px;"><br/></div><div style="font-size: 14px;"><br/></div><div style="font-size: 14px;"><br/></div><div style="font-size: 14px;"><br/></div><div style="font-size: 14px;"><br/></div><div style="font-size: 14px;"><br/></div><div style="font-size: 14px;"><br/></div></span>
</div></body></html> 